{% extends "../base/base.html" %}
{% load humanize %}
{% load custom_tags %}

{% block title %}Copy Trading{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h4>Leader: {{ leader.user.nick_name }}</h4>

        <p>
            {% if following %}
            <a href="{% url 'copytrading:stop_copying' leader.id %}" class="btn btn-danger btn-sm w-100">Stop Copying</a>
            {% else %}
            <a href="{% url 'copytrading:follow_portfolio' leader.id %}" class="btn btn-primary btn-sm w-100">Copy</a>
            {% endif %}
        </p>
    </div>
</div>



<h5>P&L Summary</h5>
<ul>
    <li>Total Realized P&L: ${{ pnl.total_realized_pnl|floatformat:2|intcomma }}</li>
    <li>ROI: {{ pnl.roi_percent|floatformat:2 }}%</li>
</ul>

<h5>Recent Mirrored Trades</h5>
<table class="table table-sm">
    <thead>
        <tr>
            <th>Asset</th>
            <th>Type</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Note</th>
            <th>Time</th>
        </tr>
    </thead>
    <tbody>
        {% for trade in mirrored_trades %}
        <tr>
            <td>{{ trade.asset.symbol }}</td>
            <td>{{ trade.trade_type }}</td>
            <td>{{ trade.quantity|floatformat:2 }}</td>
            <td>${{ trade.price|floatformat:2 }}</td>
            <td>{{ trade.note }}</td>
            <td>{{ trade.timestamp }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6">No mirrored trades yet</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}